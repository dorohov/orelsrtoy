"use strict";!function(){$(function(){$(".azbn__property-gallery").each(function(e){var t=$(this),i=t.find(".azbn__property-gallery__move-me"),a=t.find(".azbn__property-gallery__item_full"),n=i.find(".azbn__property-gallery__item_sm"),r=t.find(".azbn__property-gallery__next"),o=t.find(".azbn__property-gallery__prev");n.length&&(n.each(function(e){var t=$(this),i=t.position().top;t.attr("data-position-top",i).attr("data-item-index",e+1)}),n.on("click.azbn",function(e){e.preventDefault();var t=$(this),r=t.attr("data-photo-id")||0,o=a.filter('[data-photo-id="'+r+'"]').eq(0);if(!screenJS.isXS()){var s=parseInt(t.attr("data-position-top")),p=(parseInt(t.attr("data-item-index")),i.outerHeight(!0)),l=i.parent().outerHeight(!0),_=t.outerHeight(!0);p-s+_>l&&i.attr("data-translate-y",s).css({transform:"translateY(-"+s+"px)"})}n.filter(".is--active").removeClass("is--active"),t.addClass("is--active"),a.filter(".is--active").removeClass("is--active"),o.addClass("is--active")}),r.on("click.azbn",function(e){e.preventDefault();var t=($(this),n.filter(".is--active").next());t.length?t.trigger("click.azbn"):n.eq(0).trigger("click.azbn")}),o.on("click.azbn",function(e){e.preventDefault();var t=($(this),n.filter(".is--active").prev());t.length?t.trigger("click.azbn"):n.eq(-1).trigger("click.azbn")}))}),$(".azbn__api__property-selection__form").each(function(e){var t=$(this);t.find("input, select").on("change keyup blur",function(e){t.trigger("submit.azbn")}),t.find("select option").on("click",function(e){$(this).closest("select").trigger("blur")}),t.on("submit.azbn",function(e){e.preventDefault();var i=t.clone(!0),a=$("<input/>",{type:"hidden",name:"method",value:"iblocks/property/selection"});a.appendTo(i);var n=i.serialize();$.post("/api/",n,function(e){if(i.empty().remove(),e=JSON.parse(e),e.response&&e.response.buildings){$(".azbn__api__property-selection__result .azbn__api__property-selection__result__item").hide();for(var t in e.response.buildings)!function(e,t){$('.azbn__api__property-selection__result .azbn__api__property-selection__result__item[data-building-id="'+e+'"]').fadeIn("fast")}(t,e.response.buildings[t])}else $(".azbn__api__property-selection__result .azbn__api__property-selection__result__item").fadeIn("fast")})})}),$(document.body).on("submit",".azbn-api-formsave",{},function(e){e.preventDefault();var t=$(this),i=t.clone(!0),a=t.attr("data-method")||"formsave";i.append($("<input/>",{type:"hidden",name:"method",value:a})),$.post("/api/",i.serialize(),function(e){e=JSON.parse(e),i.empty().remove(),t.trigger("reset"),t.closest(".modal").modal("hide")})})})}();